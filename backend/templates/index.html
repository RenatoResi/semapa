{% extends "base.html" %}

{% block title %}Cadastro - Sistema SEMAPA{% endblock %}

{% block content %}
<h1>Sistema SEMAPA - Gestão Arbórea</h1>

<section>
    <h2>Cadastro de Requerente</h2>
    <form id="form-requerente" autocomplete="off">
        <div class="form-row">
            <div class="form-group">
                <label for="nome">Nome</label>
                <input id="nome" name="nome" type="text" required>
                <div id="nome-erro" class="erro-mensagem" style="display:none;"></div>
            </div>
            <div class="form-group">
                <label for="telefone">Telefone</label>
                <input id="telefone" name="telefone" type="tel" oninput="formatarTelefone(this)" maxlength="15">
            </div>
        </div>
        <div class="form-group">
            <label for="observacao-requerente">Observação</label>
            <input id="observacao-requerente" name="observacao" type="text">
        </div>
        <button type="submit">Cadastrar</button>
    </form>
</section>

<h3>Requerentes</h3>
<table id="requerentes-lista">
    <thead>
        <tr>
            <th>ID</th>
            <th>Nome</th>
            <th>Telefone</th>
            <th>Observação</th>
        </tr>
    </thead>
    <tbody></tbody>
    <div id="paginacao-requerentes" style="margin-top: 20px;"></div>
</table>

<section id="cadastro-arvore">
    <h2>Cadastro de Árvore</h2>
    <form id="form-arvore" autocomplete="off">
        <div class="form-row">
            <div class="form-group">
                <label for="endereco">Endereço</label>
                <input id="endereco" name="endereco" type="text">
            </div>
            <div class="form-group">
                <label for="bairro">Bairro</label>
                <input id="bairro" name="bairro" type="text">
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label for="latitude">Latitude</label>
                <input id="latitude" name="latitude" type="text">
            </div>
            <div class="form-group">
                <label for="longitude">Longitude</label>
                <input id="longitude" name="longitude" type="text">
            </div>
        </div>
        <div class="form-row">
            <div class="form-group">
                <label for="data_plantio">Data de Plantio</label>
                <input id="data_plantio" name="data_plantio" type="date">
            </div>
            <div class="form-group">
                <label for="especie_input">Espécie</label>
                <input id="especie_input" name="especie_nome" type="text" class="form-control" autocomplete="off" placeholder="Digite o nome popular ou científico">
                <input type="hidden" id="especie_id" name="especie_id">
                <div id="autocomplete-list" class="autocomplete-items"></div>
                <button type="button" id="btn-nova-especie" style="display:none;">Cadastrar nova espécie</button>
            </div>
            <div id="nova-especie-campos" style="display:none; margin-top:10px;">
                <input type="text" id="nova_nome_popular" name="nova_nome_popular" placeholder="Nome popular" class="form-control" required disabled>
                <input type="text" id="nova_nome_cientifico" name="nova_nome_cientifico" placeholder="Nome científico" class="form-control" disabled>
                <button type="button" id="btn-cancelar-nova-especie" class="btn btn-secondary">Cancelar</button>
            </div>
        </div>
        <div class="form-group">
            <label for="observacao-arvore">Observação</label>
            <input id="observacao-arvore" name="observacao" type="text">
        </div>
        <button type="submit">Cadastrar</button>
    </form>
</section>

<h3>Árvores</h3>
<table id="arvores-lista">
    <thead>
        <tr>
            <th>ID</th>
            <th>Espécie</th>
            <th>Endereço</th>
            <th>Bairro</th>
            <th>Ações</th>
        </tr>
    </thead>
    <tbody></tbody>
    <div id="paginacao-arvores" style="margin-top: 20px;"></div>
</table>

<div id="map"></div>
<button onclick="gerarKML()" class="btn-kml">
    Gerar KML de Todas as Árvores
</button>
{% endblock %}

{% block scripts %}
<script src="https://unpkg.com/maplibre-gl@3.6.1/dist/maplibre-gl.js"></script>
<script src="{{ url_for('static', filename='js/renderer.js') }}"></script>
{% endblock %}
